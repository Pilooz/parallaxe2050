<%- include('../partials/head', { data: data }) %>
<!-- START // Styles in head -->
    <link type="text/css" href="css/hardware/step-2.css" rel="stylesheet">
<!-- END // Styles in head -->
<%- include('../partials/header', { data: data }) %>

<div id="thumbnail">
    <img src="medias/hardware/laetitia-intro.PNG" />
</div>

<div id="waitingRoberta">
    <img src="medias/hardware/arduino-braccio-robotic-arm.jpg" />
    <h1>Roberta</h1>
    <small></small>
    <div class="message">En attente de câblage</div>
    <div class="animation">
        <div class="spinner"></div>
    </div>
</div>

<script>
$(document).ready(function() {
    var nextStep = '<%-data.currentStep.transitions[0].id %>';
    var solutions = false;

    // Récupère la référence
    $('small').html('REF : ' + JSON.parse('<%- JSON.stringify(data.reference) %>'));

    // 
    socket.on('toclient.solutions', function(data){
    if (data.state) {
        solutions = true;
        $('.message').html('Câblage validé. Informations en cours de transfert sur Roberta.');
    } else {
        solutions = false;
        $('.message').html('Erreur dans le câblage. Merci de décâbler au plus vite pour éviter une panne.');
    }
    });
    socket.on('toclient.robotFinished', function(){
        if (solutions) {
            socket.emit('toserver.nextStep', {nextStep: nextStep});
        }
    });
});
</script>

<!-- START // Scripts in footer -->
<!-- END // Scripts in footer -->
<%- include('../partials/footer', { data: data }) %>